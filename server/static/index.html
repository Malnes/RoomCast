<!doctype html>
<html lang="en">
<head>
  <title>RoomCast</title>
  <link rel="stylesheet" href="/static/app.css">
</head>
<body>
  <div id="cover-art-backdrop" aria-hidden="true"></div>
  <div class="shell">
    <header>
      <h1>RoomCast</h1>
      <div class="header-actions">
        <div class="add-node-container" data-add-node-container>
          <button id="add-node-button" class="icon-btn add-node-button" aria-haspopup="true" aria-expanded="false">Add node ▾</button>
          <div id="add-node-menu" class="add-node-menu" role="menu" aria-hidden="true">
            <button id="add-hardware-node" type="button" role="menuitem">Add hardware node</button>
            <button id="create-web-node" type="button" role="menuitem">Create web node</button>
          </div>
        </div>
        <button id="open-settings" class="icon-btn gear-btn" aria-label="Settings">⚙︎</button>
      </div>
    </header>

    <div id="error" class="toast error" style="display:none; opacity:0;"></div>
    <div id="success" class="toast success" style="display:none; opacity:0;"></div>

    <div class="nodes-section">
      <div class="section-title">Nodes</div>
      <div id="nodes"></div>
    </div>

  </div>

  <div id="player-panel">
    <div class="player-top">
      <div class="player-meta">
        <img id="player-art" src="" alt="" style="display:none;">
        <div class="player-text">
          <div id="player-title" class="player-title">Player unavailable</div>
          <div id="player-artist" class="player-artist">—</div>
        </div>
      </div>
      <div class="player-volume-inline" id="player-volume-inline">
        <button class="player-volume-toggle player-icon-btn" id="player-volume-toggle" type="button" aria-label="Adjust master volume" aria-expanded="false"></button>
        <div class="player-volume-slider" aria-hidden="true">
          <input type="range" id="master-volume" min="0" max="100" value="75" aria-label="Master volume">
        </div>
      </div>
    </div>
    <div class="player-progress">
      <input type="range" id="player-seek" min="0" max="100" value="0">
      <div class="player-time-row">
        <span id="player-time-current">0:00</span>
        <span id="player-time-total">0:00</span>
      </div>
    </div>
    <div class="player-controls">
      <button class="player-icon-btn" id="player-shuffle" aria-label="Shuffle"></button>
      <button class="player-icon-btn" id="player-prev" aria-label="Previous"></button>
      <button class="player-icon-btn play" id="player-play" aria-label="Play/Pause"></button>
      <button class="player-icon-btn" id="player-next" aria-label="Next"></button>
      <button class="player-icon-btn" id="player-repeat" aria-label="Repeat"></button>
    </div>
  </div>

  <div id="settings-overlay" class="settings-overlay">
    <div class="settings-card">
      <div class="settings-header">
        <div class="section-title" style="margin:0;">Settings</div>
        <button id="close-settings" class="icon-btn">✕</button>
      </div>
      <div class="panel collapsible-panel" data-collapsible>
        <button class="collapsible-header" type="button" aria-expanded="false">
          <span class="section-title" style="margin:0;">General</span>
          <span class="collapsible-icon" aria-hidden="true">▾</span>
        </button>
        <div class="collapsible-content" aria-hidden="true">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
            <div>
              <div class="label" style="margin:0;">Use cover art as background</div>
              <div class="muted" style="font-size:12px;">Applies the current track art as a blurred backdrop across the app.</div>
            </div>
            <input id="cover-art-background" type="checkbox" style="width:auto;" checked>
          </div>
        </div>
      </div>

      <div class="panel collapsible-panel" data-collapsible>
        <button class="collapsible-header" type="button" aria-expanded="false">
          <span class="section-title" style="margin:0;">Spotify setup</span>
          <span class="collapsible-icon" aria-hidden="true">▾</span>
        </button>
        <div class="collapsible-content" aria-hidden="true">
          <div class="muted" id="librespot-status" style="margin-bottom:8px;">Status: unknown</div>
          <div class="grid">
            <div>
              <label>Spotify client ID</label>
              <input id="sp-client-id" placeholder="client id">
            </div>
            <div>
              <label>Spotify client secret</label>
              <input id="sp-client-secret" type="password" placeholder="client secret">
            </div>
            <div>
              <label>Redirect URI</label>
              <input id="sp-redirect" placeholder="http://localhost:8000/api/spotify/callback">
            </div>
            <div>
              <label>Device name</label>
              <input id="sp-name" placeholder="RoomCast">
            </div>
            <div>
              <label>Bitrate</label>
              <select id="sp-bitrate">
                <option value="96">96 kbps</option>
                <option value="160">160 kbps</option>
                <option value="320" selected>320 kbps</option>
              </select>
            </div>
            <div>
              <label>Initial volume</label>
              <input id="sp-initvol" type="range" min="0" max="100" value="75">
            </div>
            <div style="display:flex; align-items:center; gap:6px;">
              <label style="margin:0;">Volume normalisation</label>
              <input id="sp-normalise" type="checkbox" style="width:auto;">
            </div>
        </div>
          <div style="margin-top:12px;">
            <button id="save-spotify">Save Spotify config</button>
            <div id="spotify-spinner" style="display:none; margin-top:8px;"><span class="spinner"></span> <span class="muted">Saving & restarting…</span></div>
            <div style="margin-top:8px;">
            <button class="small-btn" id="spotify-auth">Link Spotify account</button>
            <button class="small-btn" id="spotify-dashboard">Open Spotify developer dashboard</button>
            <div id="spotify-link-status" class="status-pill warn" style="margin-top:6px;">Account link status: unknown</div>
            <div class="muted" style="font-size:12px;">Create Client ID/Secret in the dashboard, save them here, then click “Link Spotify account”. Password sign-ins are no longer supported.</div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel collapsible-panel" data-collapsible>
        <button class="collapsible-header" type="button" aria-expanded="false">
          <span class="section-title" style="margin:0;">Snapcast clients (view)</span>
          <span class="collapsible-icon" aria-hidden="true">▾</span>
        </button>
        <div class="collapsible-content" aria-hidden="true">
          <div id="clients-settings"></div>
        </div>
      </div>

    </div>
  </div>

  <div id="discover-overlay" class="settings-overlay">
    <div class="settings-card">
      <div class="settings-header">
        <div class="section-title" style="margin:0;">Discover nodes</div>
        <button id="close-discover" class="icon-btn">✕</button>
      </div>
      <div style="display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:8px;">
        <div class="muted" style="flex:1; min-width:200px;">Scans all available networks and streams results live.</div>
        <button id="start-discover" class="small-btn" style="min-width:120px;">Scan</button>
      </div>
      <div id="discover-spinner" style="margin-bottom:8px; display:none;"><span class="spinner"></span> <span class="muted">Scanning...</span></div>
      <div id="discover-status" class="muted">Ready to scan.</div>
      <div id="discover-list"></div>
    </div>
  </div>

  <script src="/static/app.js"></script>

</body>
</html>
